<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
		<meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
		<title>理赔详情</title>
		<link rel="stylesheet" type="text/css" href="../../../css/api.css" />
		<link rel="stylesheet" type="text/css" href="../../../css/aui/aui_2_0.css" />
		<link rel="stylesheet" type="text/css" href="../../../css/swiper/swiper_min.css" />
		<link rel="stylesheet" type="text/css" href="../../../css/common/common.css" />
		<style type="text/css">
			html,
			body {
				background: #fff;
				height: 32rem;
			}

			.title {
				position: relative;
				width: 100%;
				height: auto;
			}

			.title_bg {
				position: absolute;
				width: 100%;
				height: auto;
			}
			.title_content{
				position: absolute;
				width: 100%;
				height: auto;
				top: 0.7rem;
			}

			.title_one {
				width: 94%;
				height: auto;
				background: #fff;
				border-radius: 15px 15px 0 0;
				padding: 0.3125rem 0.625rem 0;
				margin-left: 3%;
				z-index: 3;
			}

			.title_one_state1 {
				width: 100%;
				height: 2rem;
				line-height: 2rem;
				margin-top: 0.3rem;
			}

			.title_one_state1_t,
			.title_one_state1_s {
				width: 50%;
				height: 2rem;
				line-height: 2rem;
				font-size: 1.2rem;
			}

			.title_one_state1_s {
				margin-left: 50%;
				margin-top: -2rem;
				color: #999;
				font-size: 0.8rem;
				text-align: right;
			}
			.title_one_state1_s_q{
				color: #FF7D7B;
			}
			
			.title_one_state1_s_y{
				color: #3F86FF;
			}

			.title_one_time {
				width: 100%;
				height: 1.5rem;
				line-height: 1.5rem;
				color: #323E55;
				font-size: 0.8rem;
			}

			.title_one_tips {
				width: 100%;
				height: 2rem;
				top: 4rem;
			}

			.title_one_tips_img {
				width: 6%;
				height: 2rem;
			}

			.title_one_tips img {
				width: 0.7rem;
				height: 0.7rem;
			}

			.title_one_tips_name {
				width: 100%;
				padding-left: 1rem;
				margin-top: -2rem;
				font-size: 0.7rem;
				color: #FF7D7B;
				text-align: justify;
			}
			.title_one_tips_name_n{
				color: #9D9EA7;
			}

			.title_two {
				position: relative;
				width: 94%;
				height: 3.3rem;
				margin-left: 3%;
				z-index: 2;
			}

			.title_two img {
				width: 100%;
				height: auto;
			}

			.title_three {
				position: relative;
				width: 94%;
				height: auto;
				margin-left: 3%;
				background: #fff;
				border-radius: 0 0 15px 15px;
				padding: 0.3125rem 0.625rem;
				box-shadow: 0 2px 8px #D7D7D7;
				margin-bottom: 1rem;
				z-index: 1;
			}
			.examine_fail{
				position: absolute;
				width: 4rem;
				height: 4rem;
				right: 2rem;
				top: 2rem;
			}
			.examine_fail img{
				width: 4rem;
				height: auto;
			}
			.list1{
				position: relative;
				width: 100%;
				height: 1.5rem;
			}
			.list_item1{
				position: absolute;
				width: 30%;
				height: 1.5rem;
				line-height: 1.5rem;
				font-size: 0.8rem;
				color: #27344C;
			}
			.list_item2{
				position: absolute;
				width: 70%;
				height: 1.5rem;
				line-height: 1.5rem;
				left: 30%;
				font-size: 0.8rem;
				color: #323E55;
			}
			.list3{
				width: 100%;
				height: auto;
			}
			.list3_title{
				width: 100%;
				height: 1.5rem;
				line-height: 1.5rem;
				font-size: 1rem;
				font-weight: 700;
				margin-top:1rem;
			}
			.list3_content{
				width: 100%;
				height: auto;
				margin-top: 1rem;
			}
			.list3_content_one,.list3_content_two{
				position: relative;
				width: 100%;
				height: 7rem;
			}
			.list3_content_one_item1,.list3_content_two_item1{
				width: 100%;
				height: 1rem;
				font-size: 0.8rem;
				line-height: 1rem;
				margin-bottom: 1rem;
			}
			.list3_content_one_img {
				position: absolute;
				width: 32%;
				height: 4rem;
			}
			.list3_content_two_img {
				position: absolute;
				width: 32%;
				height: 4rem;
				left: 0;
			}

			.list3_content_one_img img,.list3_content_two_img img {
				position: absolute;
				width: 4rem;
				height: 4rem;
				object-fit: cover;
				left: 50%;
				margin-left: -2.5rem;
			}
			.btn{
				width: 94%;
				height: 2.5rem;
				line-height: 2.5rem;
				text-align: center;
				color: #FFC696;
				background-color: #443636;
				border-radius: 1.5625rem;
				margin-left: 3%;
				margin-bottom: 1rem;
			}
		</style>

	</head>
	<body>
		<div class="title">
			<img src="../../../icon/vip/question_bank/requirement_bg.png" class="title_bg">
			<div class="title_content" id="title_one">
				<script type="text/template" id="title_one_s">
				<div class="title_one">
						<div class="title_one_state1">
							{{ if(it.status == 0){ }}
							<div class="title_one_state1_t">理赔审核中...</div>
							<div class="title_one_state1_s title_one_state1_s_q">审核中</div>
							{{ } else if(it.status == 1){ }}
							<div class="title_one_state1_t">理赔初审中...</div>
							<div class="title_one_state1_s title_one_state1_s_q">初审中</div>
							{{ } else if(it.status == 2){ }}
							<div class="title_one_state1_t">理赔复审中...</div>
							<div class="title_one_state1_s title_one_state1_s_q">复审中</div>
							{{ } else if(it.status == 3){ }}
							<div class="title_one_state1_t">理赔审核成功</div>
							<div class="title_one_state1_s title_one_state1_s_y">审核通过</div>
							{{ } else if(it.status == 9){ }}
							<div class="title_one_state1_t">理赔审核失败</div>
							<div class="title_one_state1_s">审核失败</div>
							{{ } }}
						</div>
						<div class="title_one_time">{{=it.startCompensateDt}}</div>
						{{ if(it.status == 9 || it.status == 3){ }}
							<div class="title_one_tips">
								<div class="title_one_tips_img">
									<img src="../../../icon/vip/question_bank/icon_vip_tag.jpg">
								</div>
								<div class="title_one_tips_name {{=it.status == 3?'title_one_tips_name_n':''}}">
									{{ if(it.status == 3){ }}
									您的补偿金将于7个工作日内转帐至您的付款账户，请注意查收，祝您考试顺利！
									{{ }else if(it.status == 9){ }}
									失败原因：您提供的理赔资料有误，请重新提供！
									{{ } }}
								</div>
							</div>
						{{ } }}
				</div>
				<div class="title_two">
					<img src="../../../icon/vip/question_bank/detail_division.png">
				</div>
				<div class="title_three">
					{{ if(it.status == 9){ }}
					<div class="examine_fail">
						<img src="../../../icon/vip/question_bank/examine_fail.png" >
					</div>
					{{ } }}
					<div class="list1">
						<div class="list_item1">理赔原因</div>
						<div class="list_item2">补考 ({{=it.kemu == 1?'科目一':it.kemu == 4?'科目四':'无效科目'}})</div>
					</div>
					<div class="list1">
						<div class="list_item1">考试城市</div>
						<div class="list_item2">{{=it.district.provinceName}} {{=it.district.cityName}} {{=it.district.districtName}}</div>
					</div>
					<div class="list1">
						<div class="list_item1">受保人</div>
						<div class="list_item2">{{=it.name}}</div>
					</div>
					<div class="list1">
						<div class="list_item1">手机号码</div>
						<div class="list_item2">{{=it.phone}}</div>
					</div>
					<div class="list1">
						<div class="list_item1">身份证号</div>
						<div class="list_item2">{{=it.idcardNo}}</div>
					</div>
					<div class="list1">
						<div class="list_item1">收款方式</div>
						<div class="list_item2">支付宝</div>
					</div>
					<div class="list1">
						<div class="list_item1">收款账号</div>
						<div class="list_item2">{{=it.capitalAccount}}</div>
					</div>
					<div class="list3">
						<div class="list3_title">理赔资料</div>
						<div class="list3_content">
							<div class="list3_content_one">
								<div class="list3_content_one_item1">驾驶培训服务证明</div>
								<div class="list3_content_one_img">
									<img src="../../../icon/default/icon_default.png" alt="" onerror="javascript:this.src='../../../icon/default/icon_default.png'"
									 data-echo="{{=file_load_url + it.invoicePic +'&style=image/resize,w_400'}}" tapmode onclick="openPics('{{=file_load_url + it.invoicePic}}')">
								</div>
							</div>
							<div class="list3_content_two">
								<div class="list3_content_two_item1">交管局122官网相关截图</div>
									{{ for(var i=0;i<it.trafficControlBureauPic.length;i++){ }}
									<div class="list3_content_two_img" style="left:{{=i == 1?'34%':i == 2?'68%':'0'}};">
										<img src="../../../icon/default/icon_default.png" alt="" onerror="javascript:this.src='../../../icon/default/icon_default.png'" data-echo="{{=file_load_url + it.trafficControlBureauPic[i] +'&style=image/resize,m_fill,w_400'}}" tapmode onclick="openPics('{{=file_load_url + it.trafficControlBureauPic[i]}}')">
									</div>
									{{ } }}
							</div>
						</div>
					</div>
				</div>
				{{ if((it.status == 0 || it.status == 9) && it.allowUpdateNum > 0){ }}
					<div class="btn" tapmode onclick="change();">
						修改理赔信息
					</div>
				{{ } }}
			</script>
			</div>
		</div>
		
		<script type="text/javascript" src="../../../script/api.js"></script>
		<script type="text/javascript" src="../../../script/aui/aui_tab.js"></script>
		<script type="text/javascript" src="../../../script/jquery_3_2_1_min.js"></script>
		<script src="../../../script/doT_min.js" type="text/javascript" charset="utf-8"></script>
		<script src="../../../script/swiper/swiper.min.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript" src="../../../script/common/common.js"></script>
		<script src="../../../script/echo.min.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript">
			var cache;
			var id;
			var cache_account;
			apiready = function() {
				api.parseTapmode();
				cache = api.pageParam;
				log('获取到的ID', cache)
				id = cache.cache.data.id;
				cache_account = $api.getStorage('cache_by_account').cache_account;
				log('用户缓存', cache_account)
				defaultload();
				init()
			}

			function init() {
				url = 'api/questionviporder/get-question-vip-service-compensate-info-by-id';
				params = {
					id: id
				}
				ajax_Request(url, 'get', 'json', params, function(ret, err) {
					log('详情信息', ret)
					if (ret) {
						closedefaultload();
						if (ret.code == 0) {
							var local = ret.questionVipServiceCompensateInfo;
							local.insertDtNumber = (new Date(local.insertDtNumber)).Format('yyyy-MM-dd hh:mm');
							local.idcardNo = cache_account.idcardNo;
							local.trafficControlBureauPic = local.trafficControlBureauPic.split(',');
							log('local', local)
							var title_one_s = $("#title_one_s").html();
							$("#title_one").html(doT.template(title_one_s)(local));
							setTimeout(function() {
								echoInit();
							}, 300)
						} else {
							alert_msg(ret.msg)
						}
					} else {
						alert_msg('服务器异常，请稍后重试')
					}
				})
			}

			/**
			 * @param {Object} path查看图片
			 */
			function openPics(path) {
				console.log('path:' + path);
				param = {
					path: path
				}
				api.openFrame({
					name: 'common_pic_detail_frm',
					url: '../../common/common_pic_detail_frm.html',
					bgColor: 'rgba(0,0,0,0.6)',
					rect: {
						x: 0,
						y: 0,
						w: 'auto',
						h: api.winHeight
					},
					bounces: false,
					scaleEnabled: true,
					pageParam: param,
					softInputBarEnabled: true,
					softInputMode: 'resize'
				});
			}
			function change(){
				api.openWin({
						name: 'online_claim_settlement_update_win',
						url: './online_claim_settlement_update_win.html',
						slidBackEnabled: 'false',
						vScrollBarEnabled: 'false',
						hScrollBarEnabled: 'false',
						reload: true,
						useWKWebView: false,
						pageParam: {
							id:id
						}
					})
				}
			
		</script>
	</body>
</html>
