<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <title>训练记录</title>
    <link rel="stylesheet" type="text/css" href="../../css/api.css"/>
    <link rel="stylesheet" type="text/css" href="../../css/aui/aui_2_0.css" />
    <link rel="stylesheet" type="text/css" href="../../css/aui/aui_list_swipe.css"/>
    <link rel="stylesheet" type="text/css" href="../../css/common/common.css" />
    <style>
    	body{
    		
    	}
    	.aui-list:before {
		    height: 1px;
		    background-color: #FFF;
		    display: block;
		    content: '';
		    position: absolute;
		    top: 0;
		    left: 0;
		    right: auto;
		    bottom: auto;
		    width: 100%;
		    z-index: 2;
		    -webkit-transform-origin: 50% 100%;
		    transform-origin: 50% 100%;
		    pointer-events: none;
		}
		.room_list{
	    	overflow: hidden;
	    	zoom: 1;
		}
		.room_list_div{
			overflow-x:hidden;
			width:100%;
		}
		.list_div{
		    min-height: 2.2rem;
    		padding: 0 0.3rem;
			background: #FFF;
			transition: all 0.5s;
			-webkit-transition: all 0.5s;
		    position: relative;
		}
		.list_div:after{
			content: '';
		    height: 1px;
		    background: #DDDDDD;
		    width: 100%;
		    background-color: #dddddd;
		    display: block;
		    -webkit-transform: scaleY(0.5);
		    transform: scaleY(0.5);
		    -webkit-transform-origin: 50% 100%;
		    transform-origin: 50% 100%;
		}
		.swipeleft{
			min-height:2.2rem;
			padding: 0 0.3rem;
			background: #FFF;
			transition: all 0.5s;
			-webkit-transition: all 0.5s;
			transform:translateX(-50%);
			-webkit-transform:translateX(-50%);
		    position: relative;
		}
		.swipeleft:after{
			content: '';
		    height: 1px;
		    background: #DDDDDD;
		    width: 100%;
		    background-color: #dddddd;
		    display: block;
		    -webkit-transform: scaleY(0.5);
		    transform: scaleY(0.5);
		    -webkit-transform-origin: 50% 100%;
		    transform-origin: 50% 100%;
		}
		.option-btn{
		    text-align: center;
		    background: #F55252;
		    width: 50%;
		    float: right;
		    position: absolute;
		    height: 100%;
	    	display: flex;
		    top: 0;
		    right: -50%;
		    color: #fff;
		}
		.recode-title{
			height:1.5rem;
			font-size:0.7rem;
			line-height:1.5rem;
		    padding-top: 0.3rem;
		}
		.recode-title img{
			height:1rem;
			margin-bottom: -0.3rem;
		}
		.recode-title font{
			color:#7D7D7D;
		}
		.recode-content{
			width:100%;
			overflow:hidden;
			margin-top: 0.5rem;
			position: relative;
		}
		.recode-img{
			width:20%;
			float:left;
		}
		.recode-img_div{
			width:3.5rem;
			height:3.5rem;
		    margin: auto;
		}
		.recode-img_div img{
			width:100%;
			height:100%;
			object-fit:cover;
			border-radius: 0.2rem;
		}
		.recode-txt{
			width:80%;
			float:right;
		    padding: 0 0.5rem;
	        position: relative;
		}
		.txt-title{
			font-size:0.7rem;
		}
		.txt-start{
			font-size:0.7rem;
			color:#7D7D7D;
		}
		.txt-submit-time{
			font-size:0.7rem;
			color:#7D7D7D;
		}
		.txt-price{
			font-size: 0.6rem;
		    text-align: right;
		    height: 2rem;
		    line-height: 2rem;
		}
		.txt-price span{
			font-size:0.8rem;
		}
		.recode-status{
		    font-size: 0.7rem;
		    position: absolute;
		    right: 0.5rem;
		}
		.w-orange{
			color:#FA5001;
		}
		.operation{
		    width: 50%;
    		height: 100%;
		}
		.navigation{
		    width: 100%;
    		height: 50%;
    		display:flex;
		    background: #F7B24D;
		}
		.navigation span{
		    margin:auto;
		}
		.navigation img{
		    margin:auto;
		    width:2rem;
		}
		.pay{
		    width: 50%;
    		display: flex;
		}
		.pay span{
		    margin:auto;
		}
		.bg-yellow{
		    background: #F5D348;
		}
		.pay-blue{
		    background: #55BFFA;
		}
		.pay-gray{
		    background: #A0A0A0;
		}
    </style>
</head>
<body>
	<div class="room_list">
		<div class="room_list_div">
			<!-- <div class="list_div">
				<div class='recode-title'>
					<img src="../../icon/common/icon_place.png" alt="" />
					<span>上虞海滨考场<font>&ensp;500米</font></span>
				</div>
				<div class='recode-content'>
					<div class='recode-img'>
						<div class='recode-img_div'><img src="../../image/demo/school/2.jpg" alt="" /></div>
					</div>
					<div class='recode-txt'>
						<div class='recode-status w-orange'>未支付</div>
						<div class='txt-title'>预约记录1</div>
						<div class='txt-submit-time'>下单时间：2018-12-25 15:50:21</div>
						<div class='txt-start'>训练时间：<span>2018年12月25日 18:00 ~ 19:00</span><br>
							&emsp;&emsp;&emsp;&emsp;&emsp;<span>2018年12月26日 8:00 ~ 9:00</span><br>
							&emsp;&emsp;&emsp;&emsp;&emsp;<span>2018年12月27日 8:00 ~ 9:00</span>
						</div>
						<div class='txt-price'>共三个时间段：合计 ￥<span>150.0</span></div>
					</div>
				</div>
				<div class='option-btn'>
					<div class='operation'>
						<div class='navigation bg-yellow'><img src="../../icon/common/icon_navigation.png" alt="" /></div>
						<div class='navigation'><img src="../../icon/common/icon_detail.png" alt="" /></div>
					</div>
					<div class='pay'><span>去支付</span></div>
				</div>
			</div> -->
		</div>
	</div>
	<script type="text/template" charset="utf-8" id='recode_practice_src'>
		{{ for(var i=0;i<it.length;i++){ }}
			<div class="list_div">
				<div class='recode-title'>
					<img src="../../icon/common/icon_place.png" alt="" />
					<span>{{=it[i].name}}<font>&ensp;{{=calcuDistance(it[i].distance)}}</font></span>
				</div>
				<div class='recode-content'>
					<div class='recode-img'>
						<div class='recode-img_div'><img src="{{=it[i].img}}" alt="" /></div>
					</div>
					<div class='recode-txt'>
						<div class='recode-status w-orange'>
							{{ if(it[i].status == 0){ }}
								<span>未支付</span>
							{{ }else if(it[i].status == 1){ }}
								<span>已支付，未训练</span>
							{{ }else if(it[i].status == 2){ }}
								<span>训练中</span>
							{{ }else if(it[i].status == 3){ }}
								<span>训练结束</span>
							{{ }else if(it[i].status == 4){ }}
								<span>已评价</span>
							{{ } }}
						</div>
						<div class='txt-title'>{{=it[i].title}}</div>
						<div class='txt-submit-time'>下单时间：{{=it[i].submit_time}}</div>
						<div class='txt-start'>训练时间：
							{{ for(var j=0;j<it[i].practice_time.length;j++){ }}
								{{ if(j == 0){ }}
									<span>{{=it[i].practice_time[j].time}}</span><br>
								{{ }else{ }}
									&emsp;&emsp;&emsp;&emsp;&emsp;<span>{{=it[i].practice_time[j].time}}</span><br>
								{{ } }}
							{{ } }}
						</div>
						<div class='txt-price'>共{{=it[i].practice_time.length}}个时间段：合计 ￥<span>{{=it[i].price}}</span></div>
					</div>
				</div>
				<div class='option-btn'>
					<div class='operation'>
						<div class='navigation bg-yellow'><img src="../../icon/common/icon_navigation.png" alt="" /></div>
						<div class='navigation'><img src="../../icon/common/icon_detail.png" alt="" /></div>
					</div>
					{{ if(it[i].status == 0){ }}
						<div class='pay'><span>去支付</span></div>
					{{ }else if(it[i].status == 1){ }}
						<div class='pay pay-blue'><span>开始训练</span></div>
					{{ }else if(it[i].status == 2){ }}
						<div class='pay pay-blue'><span>结束训练</span></div>
					{{ }else if(it[i].status == 3){ }}
						<div class='pay pay-blue'><span>去评价</span></div>
					{{ }else if(it[i].status == 4){ }}
						<div class='pay pay-gray'><span>已完结</span></div>
					{{ } }}
					</div>
				</div>
			</div>
		{{ } }}
	</script>
</body>
<script type="text/javascript" src="../../script/api.js"></script>
<script type="text/javascript" src="../../script/jquery_3_2_1_min.js"></script>
<script type="text/javascript" src="../../script/doT_min.js"></script>
<script type="text/javascript" src="../../script/common/common.js"></script>
<script type="text/javascript">
	var demoJson1 = [
		{'name':'上虞滨海考场','title':'训练记录一','status':0,'submit_time':'2018-12-25 16:48:50','distance':'500','img':'../../image/demo/school/2.jpg','price':'152.0',
			'practice_time':[
				{'time':'2018年12月25日 18:00 ~ 19:00'},
				{'time':'2018年12月26日 18:00 ~ 19:00'},
				{'time':'2018年12月27日 18:00 ~ 19:00'}
			]
		},
		{'name':'上虞滨海考场','title':'训练记录二','status':1,'submit_time':'2018-12-25 16:48:50','distance':'1000','img':'../../image/demo/school/1.jpg','price':'33.0',
			'practice_time':[
				{'time':'2018年12月25日 18:00 ~ 19:00'}
			]
		},
		{'name':'上虞滨海考场','title':'训练记录三','status':2,'submit_time':'2018-12-25 16:48:50','distance':'5510','img':'../../image/demo/school/3.jpg','price':'232.0',
			'practice_time':[
				{'time':'2018年12月25日 18:00 ~ 19:00'},
				{'time':'2018年12月26日 18:00 ~ 19:00'}
			]
		},
		{'name':'上虞滨海考场','title':'训练记录四','status':3,'submit_time':'2018-12-25 16:48:50','distance':'10520','img':'../../image/demo/school/4.jpg','price':'232.0',
			'practice_time':[
				{'time':'2018年12月25日 18:00 ~ 19:00'},
				{'time':'2018年12月26日 18:00 ~ 19:00'}
			]
		},
		{'name':'上虞滨海考场','title':'训练记录五','status':4,'submit_time':'2018-12-25 16:48:50','distance':'12590','img':'../../image/demo/school/5.jpg','price':'232.0',
			'practice_time':[
				{'time':'2018年12月25日 18:00 ~ 19:00'},
				{'time':'2018年12月26日 18:00 ~ 19:00'}
			]
		}
	];
	var demoJson2 = [
		{'name':'上虞滨海考场','title':'训练记录一','status':0,'submit_time':'2018-12-25 16:48:50','distance':'500','img':'../../image/demo/school/2.jpg','price':'152.0',
			'practice_time':[
				{'time':'2018年12月25日 18:00 ~ 19:00'},
				{'time':'2018年12月26日 18:00 ~ 19:00'},
				{'time':'2018年12月27日 18:00 ~ 19:00'}
			]
		}
	];
	var cache;
	apiready = function(){
		cache = api.pageParam.data;
		init();
	};
	function init(){
		var recode_practice_src = $('#recode_practice_src').html();
		switch(cache.type){
			//科目二训练记录
			case 'record_practice_subject_two':
				$('.room_list_div').html(doT.template( recode_practice_src )( demoJson1 ));
				swiftLeft();
				break;
			//科目三训练记录
			case 'record_practice_subject_three':
				$('.room_list_div').html(doT.template( recode_practice_src )( demoJson2 ));
				swiftLeft();
				break;	
		}
	}
	
	//加载左滑动
	function swiftLeft(){
		var expansion = null; //是否存在展开的list
		var container = document.querySelectorAll('.room_list .room_list_div .list_div');
		for(var i = 0; i < container.length; i++){
		    var x, y, X, Y, swipeX, swipeY;
		    container[i].addEventListener('touchstart', function(event) {
		        x = event.changedTouches[0].pageX;
		        y = event.changedTouches[0].pageY;
		        swipeX = true;
		        swipeY = true;
		    });
		    container[i].addEventListener('click', function(event) {
		        event.preventDefault();
                this.className = "list_div";    //点击收起
		    });
		    container[i].addEventListener('touchmove', function(event){
		        
		        X = event.changedTouches[0].pageX;
		        Y = event.changedTouches[0].pageY;
		        if(expansion){  //判断是否展开，如果展开则收起
		            expansion.className = "list_div";
		        }
		        // 左右滑动
		        if(swipeX && Math.abs(X - x) - Math.abs(Y - y) > 0){
		            // 阻止事件冒泡
		            event.stopPropagation();
		            if(X - x > 10){   //右滑
		                event.preventDefault();
		                this.className = "list_div";    //右滑收起
		            }
		            if(x - X > 10){   //左滑
		                event.preventDefault();
		                this.className = "swipeleft";   //左滑展开
		                expansion = this;
		            }
		            swipeY = false;
		        }
		        // 上下滑动
		        if(swipeY && Math.abs(X - x) - Math.abs(Y - y) < 0) {
		            swipeX = false;
		        }        
		    });
		}
    }
</script>
</html>